<!DOCTYPE html>
<html lang="pt" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gestão de Biblioteca</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    />
    <link rel="icon" href="favicon/favicon-32x32.png" type="image/x-icon" />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      .mvc-logo {
        width: 100px;
        height: 100px;
      }
    </style>
  </head>

  <body id="bloquearTeclas">
    <div class="logo-container">
      <img
        src="./frontend/assets/img/mvc-biblioteca (1).png"
        alt="Logotipo da Escola"
        class="mvc-logo"
      />
    </div>
    <h1 class="mb-3 text-primary">MVC Biblioteca</h1>
    <p class="lead mb-4 text-muted">
      Facilitando acesso ao conhecimento com um sistema simples e eficiente.
    </p>
    <a
      href="./frontend/login.php"
      class="btn btn-lg btn-custom text-white acessar"
    >
      <i class="fas fa-sign-in-alt"></i> Acessar
    </a>

    <div id="footer"></div>

    <script>
      const inputElement = document.getElementById("bloquearTeclas");
      inputElement.addEventListener("keydown", function (event) {
        if (event.shiftKey && event.key === "Shift") {
          event.preventDefault();
          window.alert("A tecla Shift tá bloqueada");
        } else if (event.ctrlKey && event.key === "Control") {
          event.preventDefault();
          window.alert("a tecla Control tá bloqueada");
        }
      });
      // Página de bloqueio para onde o usuário será redirecionado
      const larguraLimite = 300;
      const alturaLimite = 160;
      const urlBloqueio = "/bloqueado.html";

      function devtoolsAtivo() {
        return (
          window.outerWidth - window.innerWidth > larguraLimite ||
          window.outerHeight - window.innerHeight > alturaLimite
        );
      }

      function devtoolsEmulandoMobile() {
        const larguraPequena = window.outerWidth <= 500;
        const naoEhMobileReal = !/android|iphone|ipad|mobile/i.test(
          navigator.userAgent
        );
        const diferencaLargura = window.outerWidth - window.innerWidth;
        const diferencaAltura = window.outerHeight - window.innerHeight;
        const devtoolsAbertoNoMobile =
          diferencaLargura > 100 || diferencaAltura > 100;

        return larguraPequena && naoEhMobileReal && devtoolsAbertoNoMobile;
      }

      function abrirPaginaBloqueioFecharOriginal() {
        // Tenta abrir a página bloqueio numa nova aba
        const novaJanela = window.open(urlBloqueio, "_blank");

        if (novaJanela) {
          // Se abriu, tenta fechar a aba original (funciona só se foi aberta via script)
          window.close();

          // Caso não feche (normal), redireciona a aba atual para "about:blank"
          setTimeout(() => {
            if (!window.closed) {
              window.location.href = "about:blank";
            }
          }, 500);
        } else {
          // Se não conseguiu abrir nova aba, redireciona direto para bloqueio
          window.location.href = urlBloqueio;
        }
      }

      setInterval(() => {
        if (devtoolsAtivo() || devtoolsEmulandoMobile()) {
          console.warn("⚠️ DevTools detectado! Bloqueando acesso...");
          abrirPaginaBloqueioFecharOriginal();
        }
      }, 200);

      window.addEventListener("keydown", (e) => {
        if (
          e.key === "F12" ||
          (e.ctrlKey &&
            e.shiftKey &&
            ["I", "C", "J"].includes(e.key.toUpperCase()))
        ) {
          e.preventDefault();
          abrirPaginaBloqueioFecharOriginal();
        }
      });

      window.addEventListener("contextmenu", (e) => {
        e.preventDefault();
      });

      // function detectarSeODevToolsTaAberto() {
      //   if (window.outerWidth - window.innerWidth > larguraLimite || window.outerHeight - window.innerHeight > alturaLimite) {
      //     alert('DevTools tá aberto');
      //     history.back();
      //   }
      // }

      fetch("./includes/footer.html")
        .then((res) => res.text())
        .then((data) => {
          document.getElementById("footer").innerHTML = data;
        });

      document.addEventListener("DOMContentLoaded", function () {
        document.addEventListener("contextmenu", function (e) {
          e.preventDefault();
          window.alert("O Botão direito tá bloqueado, pra evitar o DevTools");
          // window.location.href = "../mvc-biblioteca/includes/pagina-da-anim.html";
        });
      });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="./frontend/_css/footer.css" />
  </body>
</html>
